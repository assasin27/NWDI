<!DOCTYPE html>
<html>
<head>
  <title>Simple Auth Test</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; padding: 20px; }
    .card { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    input, button { display: block; width: 100%; padding: 10px; margin: 10px 0; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:disabled { background: #cccccc; }
    #result { margin: 20px 0; padding: 10px; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h1>Simple Auth Test</h1>
  
  <div class="card">
    <h2>1. Sign Up (One-time)</h2>
    <input type="email" id="signup-email" placeholder="Email" />
    <input type="password" id="signup-password" placeholder="Password (min 6 chars)" />
    <button id="signupBtn">Sign Up</button>
  </div>
  
  <div class="card">
    <h2>2. Sign In</h2>
    <input type="email" id="signin-email" placeholder="Email" />
    <input type="password" id="signin-password" placeholder="Password" />
    <button id="signinBtn">Sign In</button>
    <button id="signoutBtn">Sign Out</button>
  </div>
  
  <div class="card">
    <h2>3. Test Session</h2>
    <button id="checkSessionBtn">Check Session</button>
    <div id="sessionInfo"></div>
  </div>
  
  <div id="result"></div>

  <script>
    // Supabase configuration - using anon key for client-side testing
    const SUPABASE_URL = 'https://lzjhjecktllltkizgwnr.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx6amhqZWNrdGxsbHRraXpnd25yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI1OTg0NTUsImV4cCI6MjA2ODE3NDQ1NX0.MW3fIJA4X8nnMnC-__8aloqH1tBo4IIpmA_2LPqDxug';
    
    // Initialize Supabase
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    
    // DOM Elements
    const signupBtn = document.getElementById('signupBtn');
    const signinBtn = document.getElementById('signinBtn');
    const signoutBtn = document.getElementById('signoutBtn');
    const checkSessionBtn = document.getElementById('checkSessionBtn');
    const resultDiv = document.getElementById('result');
    const sessionInfo = document.getElementById('sessionInfo');
    
    // Sign Up
    signupBtn.addEventListener('click', async () => {
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;
      
      if (!email || !password) {
        showResult('Please enter both email and password', true);
        return;
      }
      
      try {
        showResult('Creating account...', false);
        const { data, error } = await supabase.auth.signUp({
          email,
          password,
          options: {
            emailRedirectTo: window.location.href
          }
        });
        
        if (error) throw error;
        showResult(`Account created! Check your email to confirm.`, false);
      } catch (error) {
        showResult(`Error: ${error.message}`, true);
      }
    });
    
    // Sign In
    signinBtn.addEventListener('click', async () => {
      const email = document.getElementById('signin-email').value;
      const password = document.getElementById('signin-password').value;
      
      try {
        showResult('Signing in...', false);
        const { data, error } = await supabase.auth.signInWithPassword({
          email,
          password
        });
        
        if (error) throw error;
        showResult('Successfully signed in!', false);
        checkSession();
      } catch (error) {
        showResult(`Error: ${error.message}`, true);
      }
    });
    
    // Sign Out
    signoutBtn.addEventListener('click', async () => {
      try {
        const { error } = await supabase.auth.signOut();
        if (error) throw error;
        showResult('Signed out successfully', false);
        sessionInfo.innerHTML = '';
      } catch (error) {
        showResult(`Error signing out: ${error.message}`, true);
      }
    });
    
    // Check Session
    checkSessionBtn.addEventListener('click', checkSession);
    
    // Check current session
    async function checkSession() {
      try {
        const { data: { session }, error } = await supabase.auth.getSession();
        
        if (error) throw error;
        
        if (session) {
          const user = session.user;
          sessionInfo.innerHTML = `
            <h3>Active Session</h3>
            <p><strong>User ID:</strong> ${user.id}</p>
            <p><strong>Email:</strong> ${user.email}</p>
            <p><strong>Last Sign In:</strong> ${new Date(user.last_sign_in_at).toLocaleString()}</p>
          `;
          return session;
        } else {
          sessionInfo.innerHTML = '<p>No active session</p>';
          return null;
        }
      } catch (error) {
        sessionInfo.innerHTML = `<p class="error">Error: ${error.message}</p>`;
        return null;
      }
    }
    
    // Helper function to show results
    function showResult(message, isError) {
      resultDiv.textContent = message;
      resultDiv.className = isError ? 'error' : 'success';
      console.log(isError ? 'Error:' : 'Success:', message);
    }
    
    // Initial session check
    checkSession();
  </script>
</body>
</html>
